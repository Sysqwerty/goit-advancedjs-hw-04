{"version":3,"file":"commonHelpers.js","sources":["../src/js/constants.js","../src/js/api.js","../src/js/index.js"],"sourcesContent":["export const controls = {\n  page: 1,\n  per_page: 40,\n  totalHits: 0,\n  receivedHits: 0,\n  totalPages: 0,\n  searchQuery: null,\n  isLoading: false,\n};\n\nexport const selectors = {\n  form: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n};\n","import axios from 'axios';\nimport { controls } from './constants';\n\naxios.defaults.headers.common['x-api-key'] =\n  'live_nOdnL3Dj9jjF4zVLjteozldoqmiVUxxCRsrlPoRVyonLQDm4DFuaUNiaRzafsnXC';\naxios.defaults.headers = ['Access-Control-Allow-Origin'];\n\nexport async function fetchHits(searchQuery) {\n  const queryParams = new URLSearchParams({\n    key: '44202133-14fac6110a8eccaaec992feaf',\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: controls.per_page,\n    page: controls.page,\n  });\n\n  const response = await axios.get(\n    `https://pixabay.com/api/?${queryParams.toString()}`\n  );\n\n  const data = await response.data;\n  console.log('data:\\n', data);\n  return data;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchHits } from './api';\nimport { selectors, controls } from './constants';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\ngallery.on('error.simplelightbox', function (e) {\n  console.log(e);\n});\n\nselectors.form.addEventListener('submit', handlerSubmit);\nwindow.addEventListener('scroll', onScroll);\n\nfunction onScroll() {\n  if (\n    window.scrollY + window.innerHeight >=\n    document.documentElement.scrollHeight - 50\n  ) {\n    handlerLoadMore();\n  }\n}\n\nasync function handlerSubmit(evt) {\n  evt.preventDefault();\n  selectors.gallery.textContent = '';\n\n  const searchQuery = evt.target.elements.searchQuery.value;\n\n  controls.searchQuery = searchQuery;\n\n  if (!searchQuery) {\n    showToast('Please enter a search query.', 'error');\n    return;\n  }\n\n  controls.receivedHits = 0;\n  controls.totalHits = 0;\n  controls.page = 1;\n\n  try {\n    await loadData();\n    controls.totalHits ??\n      showToast(`Hooray! We found ${controls.totalHits} images.`, 'success');\n    gallery.refresh();\n  } catch (error) {\n    showToast(\n      'Sorry, there are no images matching your search query. Please try again.',\n      'error'\n    );\n  } finally {\n    evt.target.elements.searchQuery.value = '';\n  }\n}\n\nasync function loadData() {\n  selectors.loader.classList.remove('hide');\n  if (controls.isLoading) return;\n  controls.isLoading = true;\n\n  try {\n    const { totalHits, hits } = await fetchHits(controls.searchQuery);\n    controls.receivedHits += hits.length;\n    controls.totalHits = totalHits;\n\n    renderImages(hits);\n    gallery.refresh();\n\n    console.log('hits received: ', controls.receivedHits);\n    console.log('total hits: ', totalHits);\n\n    !controls.receivedHits\n      ? showToast(\n          'Sorry, there are no images matching your search query. Please try again.',\n          'error'\n        )\n      : controls.receivedHits >= totalHits &&\n        showToast(\n          `We're sorry, but you've reached the end of search results.`,\n          'info'\n        );\n  } catch (error) {\n    showToast('Error fetching data. Please try again.', 'error');\n  } finally {\n    selectors.loader.classList.add('hide');\n    controls.isLoading = false;\n  }\n}\n\nasync function handlerLoadMore() {\n  controls.page += 1;\n  await loadData();\n\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction renderImages(images) {\n  const markup = images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <div class=\"photo-card\">\n        <a href=\"${largeImageURL}\" class=\"card-link\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"card-image\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes</b> ${likes}</p>\n          <p class=\"info-item\"><b>Views</b> ${views}</p>\n          <p class=\"info-item\"><b>Comments</b> ${comments}</p>\n          <p class=\"info-item\"><b>Downloads</b> ${downloads}</p>\n        </div>\n      </div>\n    `\n    )\n    .join('');\n\n  selectors.gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction showToast(message, type = 'info') {\n  iziToast[type]({\n    message: message,\n    position: 'topRight',\n    timeout: 3000,\n  });\n}\n"],"names":["controls","selectors","axios","fetchHits","searchQuery","queryParams","data","gallery","SimpleLightbox","handlerSubmit","onScroll","handlerLoadMore","evt","showToast","loadData","totalHits","hits","renderImages","cardHeight","images","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","message","type","iziToast"],"mappings":"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"}